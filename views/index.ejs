<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VCC Confiesate</title>
    <link rel="stylesheet" href="../public/css/style.css"> 
    <link rel="icon" href="https://vcc.softromy.com/favicon.png">
    <script src="https://kit.fontawesome.com/a8192839c1.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../public/css/index-categories.css">
    <link rel="stylesheet" href="../public/css/media-queryStyle.css">
</head>
<body>
  <div id="app">
    <header class="header">
      <span class="span-max">CONFIESATE</span>
      <button class="button">Confesarme</button>
    </header>

    <div class="Messages">
      <h2>¡BIENVENIDOS A CONFIESATE!</h2>
    </div>

    <div class="section-categories">
      <p class="confesiones_total">CONFESIONES: <b class="confesionesTotal">cargando...</b></p>
      <p class="confesiones_total">ULTIMA ACTUALIZACION: <b>10/12/25</b></p>
    </div>

<section class="section">
  <div class="main-content" id="posts-container">

    <% confesiones.forEach((confesion) => { %>
      <div class="post">
        <div class="titles" style="overflow: hidden;">
          <h2 class="title-post">
            <a href="/post/<%= confesion._id %>" class="a"><%= confesion.titulo %></a>
          </h2>

          <div style="max-height: 100px; max-width: 500px;">
            <p class="descripcion-post"><%= confesion.descripcion %></p>
          </div>
        </div>

        <!-- Imagen / Video con Cloudinary -->
        <div class="image-container">
          <% const mediaFiles = confesion.imagenes; %>

          <% if (mediaFiles && mediaFiles.length > 0) { %>
            <% const firstMediaFile = mediaFiles[0]; %>

            <% if (firstMediaFile.match(/\.mp4|\.webm|\.ogg|\.mkv$/)) { %>
              <a href="/post/<%= confesion._id %>" style="text-decoration: none;">
                <video controls class="img-post">
                  <source src="<%= firstMediaFile %>" type="video/mp4">
                  Tu navegador no soporta video.
                </video>
              </a>

            <% } else { %>
              <a href="/post/<%= confesion._id %>" class="img-a">
                <img src="<%= firstMediaFile %>" alt="Imagen del post" class="img-post">
              </a>
            <% } %>
          <% } %>
        </div>

        <div class="opciones">
          <a href="/post/<%= confesion._id %>" style="text-decoration: none; color: #5f5f5f;">
            <div class="option_conten comment-conten">
              <span class="span-comment">Comentarios</span>
            </div>
          </a>

          <div class="option_conten heart-conten">
            <span class="span-heart">Me gusta</span>
          </div>
        </div>

      </div>
    <% }); %>

  </div>
</section>

<div class="footer2">
  <button id="load-more-button">Cargar más</button>
  <footer class="footer">
    <p>&copy; 2023 Confiesate Ccalamaquino</p>
  </footer>
</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
<script src="../public/js/main.js" type="module"></script>

</html>
